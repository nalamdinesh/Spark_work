create table finair_final_test as select mas.creationtime, b.carrier, mas.serviceclassflown, mas.trafficcategory,d.FLIGHTNUMBER1, a.airportpair, sum(numberofpax), sum(grossgrossvalue) from finair_master_test mas LEFT OUTER JOIN DIM_Airport_Pair a ON a.AIRPORTPAIR = mas.AIRPORTPAIR and a.SEGMENTPAIR = mas.SEGMENTPAIR LEFT OUTER JOIN DIM_carrier_Pair b ON b.CARRIER  = mas.CARRIER LEFT OUTER JOIN DIM_BKG_CLASS  c
on c.BOOKINGCLASS = mas.BOOKINGCLASS LEFT OUTER JOIN DIM_FLIGHT_DIM d ON d.CARRIER = mas.CARRIER and d.FLIGHTNUMBER1  = mas.FLIGHTNUMBER1 group by mas.creationtime, b.carrier, mas.serviceclassflown, mas.trafficcategory,d.FLIGHTNUMBER1, a.airportpair limit 100